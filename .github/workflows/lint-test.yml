name: Lint & Test

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  lint-test:
    runs-on: ubuntu-latest    
    env:
      BOT_TOKEN: "BOT_TOKEN"
      POETRY_VIRTUALENVS_CREATE: false

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      
      - name: Setup python
        uses: actions/setup-python@v2

      - name: Install Poetry
        run: pip install poetry --user --no-cache-dir
      
      - name: Install dependencies using poetry
        run: poetry install
      
      - name: Run pre-commit-hooks
        run: export PIP_USER=0; pre-commit run --all-files
